<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>QR Code - Library Management System</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="header">
    <img src="https://tse2.mm.bing.net/th/id/OIP.EKabs-fdvK6BTk6s2Z3EfwHaDQ?cb=ucfimg2ucfimg=1&rs=1&pid=ImgDetMain&o=7&rm=3" alt="College Logo" class="logo">
    <nav class="nav">
      <a href="/dashboard.html">Dashboard</a>
      <a href="/book-registration.html">Book Registration</a>
      <a href="/borrow-book.html">Borrow Book</a>
      <a href="/return-book.html">Return Book</a>
      <a href="/notifications.html">Notifications</a>
      <a href="/remove-books.html">Remove Books</a>
      <a href="/inventory.html" target="_blank">Inventory</a>
      <a href="/qr-code.html" class="active">QR Code</a>
      <a href="#" onclick="logout(); return false;">Logout</a>
    </nav>
  </div>

  <div class="container">
    <div class="card">
      <h2>ðŸ“² QR Code for Inventory</h2>
      <p style="margin-bottom: 20px; color: #666;">
        Print or display this QR code in your library. Students can scan it to view available books and their locations.
      </p>
      <div class="qr-container" id="qr-container">
        <p class="empty-state">Loading QR code...</p>
      </div>
      <div style="text-align: center; margin-top: 20px;">
        <p style="color: #666; margin-bottom: 10px;">
          <strong>Inventory URL:</strong><br>
          <span id="inventory-url" style="word-break: break-all;"></span>
        </p>
        <button class="btn btn-primary" onclick="window.print()">Print QR Code</button>
      </div>
    </div>
  </div>

  <script src="/js/auth.js"></script>
  <script>
    // Load QR code
    async function loadQRCode() {
      try {
        const response = await fetch('/api/qr-code');
        const data = await response.json();
        
        if (data.success) {
          const container = document.getElementById('qr-container');
          container.innerHTML = `
            <img src="${data.qrCode}" alt="QR Code for Inventory">
          `;
          document.getElementById('inventory-url').textContent = data.url;
        }
      } catch (error) {
        console.error('Error loading QR code:', error);
        document.getElementById('qr-container').innerHTML = 
          '<p class="empty-state">Error loading QR code. Please try again later.</p>';
      }
    }

    loadQRCode();
  </script>
</body>
</html>

